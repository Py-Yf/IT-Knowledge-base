# Hadoop组件

## Hadoop安装相关文件位置及配置

* /usr/bin/  : 所有Hadoop相关命令的软链，它们会再软链到/etc/alternatives中去
* /var/lib/ : Hadoop服务相关数据目录
* /var/log/   :Hadoop相关服务运行日志目录
* /opt/cloudera/parcels/CDH/jars   : hadoop所有相关服务的安装文件，包含jar包，配置文件以及执行命令等。
* /tmp  :所有Hadoop相关服务不同角色的OOM堆栈转存目录。以及所有角色启动的pid文件
* /dfs    :所有Hadoop存储文件 <br/>

## Hadoop相关配置 <br/>

#### core-site.xml
	
	<?xml version="1.0" encoding="UTF-8"?>

	<!--Autogenerated by Cloudera Manager-->
	<configuration>
	  <property>
	    <name>fs.defaultFS</name>
	    <value>hdfs://node01:8020</value>
	  </property>
	  <property>
	    <name>fs.trash.interval</name>
	    <value>1</value>
	  </property>
	  <property>
	    <name>io.compression.codecs</name>
	    <value>org.apache.hadoop.io.compress.DefaultCodec,org.apache.hadoop.io.compress.GzipCodec,org.apache.hadoop.io.compress.BZip2Codec,org.apache.hadoop.io.compress.DeflateCodec,org.apache.hadoop.io.compress.SnappyCodec,org.apache.hadoop.io.compress.Lz4Codec</value>
	  </property>
	  <property>
	    <name>hadoop.security.authentication</name>
	    <value>simple</value>
	  </property>
	  <property>
	    <name>hadoop.security.authorization</name>
	    <value>false</value>
	  </property>
	  <property>
	    <name>hadoop.rpc.protection</name>
	    <value>authentication</value>
	  </property>
	  <property>
	    <name>hadoop.security.auth_to_local</name>
	    <value>DEFAULT</value>
	  </property>
	  <property>
	    <name>hadoop.proxyuser.oozie.hosts</name>
	    <value>*</value>
	  </property>
	  <property>
	    <name>hadoop.proxyuser.oozie.groups</name>
	    <value>*</value>
	  </property>
	  <property>
	    <name>hadoop.proxyuser.mapred.hosts</name>
	    <value>*</value>
	  </property>
	  <property>
	    <name>hadoop.proxyuser.mapred.groups</name>
	    <value>*</value>
	  </property>
	  <property>
	    <name>hadoop.proxyuser.flume.hosts</name>
	    <value>*</value>
	  </property>
	  <property>
	    <name>hadoop.proxyuser.flume.groups</name>
	    <value>*</value>
	  </property>
	  <property>
	    <name>hadoop.proxyuser.HTTP.hosts</name>
	    <value>*</value>
	  </property>
	  <property>
	    <name>hadoop.proxyuser.HTTP.groups</name>
	    <value>*</value>
	  </property>
	  <property>
	    <name>hadoop.proxyuser.hive.hosts</name>
	    <value>*</value>
	  </property>
	  <property>
	    <name>hadoop.proxyuser.hive.groups</name>
	    <value>*</value>
	  </property>
	  <property>
	    <name>hadoop.proxyuser.hue.hosts</name>
	    <value>*</value>
	  </property>
	  <property>
	    <name>hadoop.proxyuser.hue.groups</name>
	    <value>*</value>
	  </property>
	  <property>
	    <name>hadoop.proxyuser.httpfs.hosts</name>
	    <value>*</value>
	  </property>
	  <property>
	    <name>hadoop.proxyuser.httpfs.groups</name>
	    <value>*</value>
	  </property>
	  <property>
	    <name>hadoop.proxyuser.hdfs.groups</name>
	    <value>*</value>
	  </property>
	  <property>
	    <name>hadoop.proxyuser.hdfs.hosts</name>
	    <value>*</value>
	  </property>
	  <property>
	    <name>hadoop.proxyuser.yarn.hosts</name>
	    <value>*</value>
	  </property>
	  <property>
	    <name>hadoop.proxyuser.yarn.groups</name>
	    <value>*</value>
	  </property>
	  <property>
	    <name>hadoop.security.group.mapping</name>
	    <value>org.apache.hadoop.security.ShellBasedUnixGroupsMapping</value>
	  </property>
	  <property>
	    <name>hadoop.security.instrumentation.requires.admin</name>
	    <value>false</value>
	  </property>
	  <property>
	    <name>net.topology.script.file.name</name>
	    <value>/etc/hadoop/conf.cloudera.yarn/topology.py</value>
	  </property>
	  <property>
	    <name>io.file.buffer.size</name>
	    <value>65536</value>
	  </property>
	  <property>
	    <name>hadoop.ssl.enabled</name>
	    <value>false</value>
	  </property>
	  <property>
	    <name>hadoop.ssl.require.client.cert</name>
	    <value>false</value>
	    <final>true</final>
	  </property>
	  <property>
	    <name>hadoop.ssl.keystores.factory.class</name>
	    <value>org.apache.hadoop.security.ssl.FileBasedKeyStoresFactory</value>
	    <final>true</final>
	  </property>
	  <property>
	    <name>hadoop.ssl.server.conf</name>
	    <value>ssl-server.xml</value>
	    <final>true</final>
	  </property>
	  <property>
	    <name>hadoop.ssl.client.conf</name>
	    <value>ssl-client.xml</value>
	    <final>true</final>
	  </property>
	</configuration>
	
<br/>

#### hadoop-env.sh

	# Prepend/Append plugin parcel classpaths

	if [ "$HADOOP_USER_CLASSPATH_FIRST" = 'true' ]; then
	  # HADOOP_CLASSPATH={{HADOOP_CLASSPATH_APPEND}}
	  :
	else
	  # HADOOP_CLASSPATH={{HADOOP_CLASSPATH}}
	  :
	fi
	# JAVA_LIBRARY_PATH={{JAVA_LIBRARY_PATH}}
	
	export HADOOP_MAPRED_HOME=$( ([[ ! '/opt/cloudera/parcels/CDH/lib/hadoop-mapreduce' =~ CDH_MR2_HOME ]] && echo /opt/cloudera/parcels/CDH/lib/hadoop-mapreduce ) || echo ${CDH_MR2_HOME:-/usr/lib/hadoop-mapreduce/}  )
	export YARN_OPTS="-Xmx825955249 -Djava.net.preferIPv4Stack=true $YARN_OPTS"
	export HADOOP_CLIENT_OPTS="-Djava.net.preferIPv4Stack=true $HADOOP_CLIENT_OPTS"

<br/>

#### hdfs-site.xml

	<?xml version="1.0" encoding="UTF-8"?>
	
	<!--Autogenerated by Cloudera Manager-->
	<configuration>
	  <property>
	    <name>dfs.namenode.name.dir</name>
	    <value>file:///dfs/nn</value>
	  </property>
	  <property>
	    <name>dfs.namenode.servicerpc-address</name>
	    <value>node01:8022</value>
	  </property>
	  <property>
	    <name>dfs.https.address</name>
	    <value>node01:50470</value>
	  </property>
	  <property>
	    <name>dfs.https.port</name>
	    <value>50470</value>
	  </property>
	  <property>
	    <name>dfs.namenode.http-address</name>
	    <value>node01:50070</value>
	  </property>
	  <property>
	    <name>dfs.replication</name>
	    <value>3</value>
	  </property>
	  <property>
	    <name>dfs.blocksize</name>
	    <value>134217728</value>
	  </property>
	  <property>
	    <name>dfs.client.use.datanode.hostname</name>
	    <value>false</value>
	  </property>
	  <property>
	    <name>fs.permissions.umask-mode</name>
	    <value>022</value>
	  </property>
	  <property>
	    <name>dfs.namenode.acls.enabled</name>
	    <value>false</value>
	  </property>
	  <property>
	    <name>dfs.client.use.legacy.blockreader</name>
	    <value>false</value>
	  </property>
	  <property>
	    <name>dfs.client.read.shortcircuit</name>
	    <value>false</value>
	  </property>
	  <property>
	    <name>dfs.domain.socket.path</name>
	    <value>/var/run/hdfs-sockets/dn</value>
	  </property>
	  <property>
	    <name>dfs.client.read.shortcircuit.skip.checksum</name>
	    <value>false</value>
	  </property>
	  <property>
	    <name>dfs.client.domain.socket.data.traffic</name>
	    <value>false</value>
	  </property>
	  <property>
	    <name>dfs.datanode.hdfs-blocks-metadata.enabled</name>
	    <value>true</value>
	  </property>
	</configuration>
<br/>

#### mapred-site.xml

	<?xml version="1.0" encoding="UTF-8"?>
	
	<!--Autogenerated by Cloudera Manager-->
	<configuration>
	  <property>
	    <name>mapreduce.job.split.metainfo.maxsize</name>
	    <value>10000000</value>
	  </property>
	  <property>
	    <name>mapreduce.job.counters.max</name>
	    <value>120</value>
	  </property>
	  <property>
	    <name>mapreduce.job.counters.groups.max</name>
	    <value>50</value>
	  </property>
	  <property>
	    <name>mapreduce.output.fileoutputformat.compress</name>
	    <value>false</value>
	  </property>
	  <property>
	    <name>mapreduce.output.fileoutputformat.compress.type</name>
	    <value>BLOCK</value>
	  </property>
	  <property>
	    <name>mapreduce.output.fileoutputformat.compress.codec</name>
	    <value>org.apache.hadoop.io.compress.DefaultCodec</value>
	  </property>
	  <property>
	    <name>mapreduce.map.output.compress.codec</name>
	    <value>org.apache.hadoop.io.compress.SnappyCodec</value>
	  </property>
	  <property>
	    <name>mapreduce.map.output.compress</name>
	    <value>true</value>
	  </property>
	  <property>
	    <name>zlib.compress.level</name>
	    <value>DEFAULT_COMPRESSION</value>
	  </property>
	  <property>
	    <name>mapreduce.task.io.sort.factor</name>
	    <value>64</value>
	  </property>
	  <property>
	    <name>mapreduce.map.sort.spill.percent</name>
	    <value>0.8</value>
	  </property>
	  <property>
	    <name>mapreduce.reduce.shuffle.parallelcopies</name>
	    <value>10</value>
	  </property>
	  <property>
	    <name>mapreduce.task.timeout</name>
	    <value>600000</value>
	  </property>
	  <property>
	    <name>mapreduce.client.submit.file.replication</name>
	    <value>3</value>
	  </property>
	  <property>
	    <name>mapreduce.job.reduces</name>
	    <value>24</value>
	  </property>
	  <property>
	    <name>mapreduce.task.io.sort.mb</name>
	    <value>256</value>
	  </property>
	  <property>
	    <name>mapreduce.map.speculative</name>
	    <value>false</value>
	  </property>
	  <property>
	    <name>mapreduce.reduce.speculative</name>
	    <value>false</value>
	  </property>
	  <property>
	    <name>mapreduce.job.reduce.slowstart.completedmaps</name>
	    <value>0.8</value>
	  </property>
	  <property>
	    <name>mapreduce.jobhistory.address</name>
	    <value>node01:10020</value>
	  </property>
	  <property>
	    <name>mapreduce.jobhistory.webapp.address</name>
	    <value>node01:19888</value>
	  </property>
	  <property>
	    <name>mapreduce.jobhistory.webapp.https.address</name>
	    <value>node01:19890</value>
	  </property>
	  <property>
	    <name>mapreduce.jobhistory.admin.address</name>
	    <value>node01:10033</value>
	  </property>
	  <property>
	    <name>mapreduce.framework.name</name>
	    <value>yarn</value>
	  </property>
	  <property>
	    <name>yarn.app.mapreduce.am.staging-dir</name>
	    <value>/user</value>
	  </property>
	  <property>
	    <name>mapreduce.am.max-attempts</name>
	    <value>2</value>
	  </property>
	  <property>
	    <name>yarn.app.mapreduce.am.resource.mb</name>
	    <value>1024</value>
	  </property>
	  <property>
	    <name>yarn.app.mapreduce.am.resource.cpu-vcores</name>
	    <value>1</value>
	  </property>
	  <property>
	    <name>mapreduce.job.ubertask.enable</name>
	    <value>false</value>
	  </property>
	  <property>
	    <name>yarn.app.mapreduce.am.command-opts</name>
	    <value>-Djava.net.preferIPv4Stack=true -Xmx825955249</value>
	  </property>
	  <property>
	    <name>mapreduce.map.java.opts</name>
	    <value>-Djava.net.preferIPv4Stack=true</value>
	  </property>
	  <property>
	    <name>mapreduce.reduce.java.opts</name>
	    <value>-Djava.net.preferIPv4Stack=true</value>
	  </property>
	  <property>
	    <name>yarn.app.mapreduce.am.admin.user.env</name>
	    <value>LD_LIBRARY_PATH=$HADOOP_COMMON_HOME/lib/native:$JAVA_LIBRARY_PATH</value>
	  </property>
	  <property>
	    <name>mapreduce.map.memory.mb</name>
	    <value>0</value>
	  </property>
	  <property>
	    <name>mapreduce.map.cpu.vcores</name>
	    <value>1</value>
	  </property>
	  <property>
	    <name>mapreduce.reduce.memory.mb</name>
	    <value>0</value>
	  </property>
	  <property>
	    <name>mapreduce.reduce.cpu.vcores</name>
	    <value>1</value>
	  </property>
	  <property>
	    <name>mapreduce.job.heap.memory-mb.ratio</name>
	    <value>0.8</value>
	  </property>
	  <property>
	    <name>mapreduce.application.classpath</name>
	    <value>$HADOOP_MAPRED_HOME/*,$HADOOP_MAPRED_HOME/lib/*,$MR2_CLASSPATH</value>
	  </property>
	  <property>
	    <name>mapreduce.jobhistory.jhist.format</name>
	    <value>binary</value>
	  </property>
	  <property>
	    <name>mapreduce.admin.user.env</name>
	    <value>LD_LIBRARY_PATH=$HADOOP_COMMON_HOME/lib/native:$JAVA_LIBRARY_PATH</value>
	  </property>
	  <property>
	    <name>mapreduce.job.redacted-properties</name>
	    <value>fs.s3a.access.key,fs.s3a.secret.key</value>
	  </property>
	  <property>
	    <name>mapreduce.job.acl-view-job</name>
	    <value> </value>
	  </property>
	  <property>
	    <name>mapreduce.job.acl-modify-job</name>
	    <value> </value>
	  </property>
	  <property>
	    <name>mapreduce.cluster.acls.enabled</name>
	    <value>false</value>
	  </property>
	</configuration>

<br/>

#### ssl-client.xml

	<?xml version="1.0" encoding="UTF-8"?>

	<!--Autogenerated by Cloudera Manager-->
	<configuration>
	  <property>
	    <name>ssl.client.truststore.type</name>
	    <value>jks</value>
	  </property>
	  <property>
	    <name>ssl.client.truststore.reload.interval</name>
	    <value>10000</value>
	  </property>
	</configuration>	
	
<br/>

#### yarn-site.xml

	<?xml version="1.0" encoding="UTF-8"?>
	
	<!--Autogenerated by Cloudera Manager-->
	<configuration>
	  <property>
	    <name>yarn.acl.enable</name>
	    <value>true</value>
	  </property>
	  <property>
	    <name>yarn.admin.acl</name>
	    <value>*</value>
	  </property>
	  <property>
	    <name>yarn.resourcemanager.address</name>
	    <value>node01:8032</value>
	  </property>
	  <property>
	    <name>yarn.resourcemanager.admin.address</name>
	    <value>node01:8033</value>
	  </property>
	  <property>
	    <name>yarn.resourcemanager.scheduler.address</name>
	    <value>node01:8030</value>
	  </property>
	  <property>
	    <name>yarn.resourcemanager.resource-tracker.address</name>
	    <value>node01:8031</value>
	  </property>
	  <property>
	    <name>yarn.resourcemanager.webapp.address</name>
	    <value>node01:8088</value>
	  </property>
	  <property>
	    <name>yarn.resourcemanager.webapp.https.address</name>
	    <value>node01:8090</value>
	  </property>
	  <property>
	    <name>yarn.resourcemanager.client.thread-count</name>
	    <value>50</value>
	  </property>
	  <property>
	    <name>yarn.resourcemanager.scheduler.client.thread-count</name>
	    <value>50</value>
	  </property>
	  <property>
	    <name>yarn.resourcemanager.admin.client.thread-count</name>
	    <value>1</value>
	  </property>
	  <property>
	    <name>yarn.scheduler.minimum-allocation-mb</name>
	    <value>1024</value>
	  </property>
	  <property>
	    <name>yarn.scheduler.increment-allocation-mb</name>
	    <value>512</value>
	  </property>
	  <property>
	    <name>yarn.scheduler.maximum-allocation-mb</name>
	    <value>2745</value>
	  </property>
	  <property>
	    <name>yarn.scheduler.minimum-allocation-vcores</name>
	    <value>1</value>
	  </property>
	  <property>
	    <name>yarn.scheduler.increment-allocation-vcores</name>
	    <value>1</value>
	  </property>
	  <property>
	    <name>yarn.scheduler.maximum-allocation-vcores</name>
	    <value>16</value>
	  </property>
	  <property>
	    <name>yarn.resourcemanager.amliveliness-monitor.interval-ms</name>
	    <value>1000</value>
	  </property>
	  <property>
	    <name>yarn.am.liveness-monitor.expiry-interval-ms</name>
	    <value>600000</value>
	  </property>
	  <property>
	    <name>yarn.resourcemanager.am.max-attempts</name>
	    <value>2</value>
	  </property>
	  <property>
	    <name>yarn.resourcemanager.container.liveness-monitor.interval-ms</name>
	    <value>600000</value>
	  </property>
	  <property>
	    <name>yarn.resourcemanager.nm.liveness-monitor.interval-ms</name>
	    <value>1000</value>
	  </property>
	  <property>
	    <name>yarn.nm.liveness-monitor.expiry-interval-ms</name>
	    <value>600000</value>
	  </property>
	  <property>
	    <name>yarn.resourcemanager.resource-tracker.client.thread-count</name>
	    <value>50</value>
	  </property>
	  <property>
	    <name>yarn.application.classpath</name>
	    <value>$HADOOP_CLIENT_CONF_DIR,$HADOOP_CONF_DIR,$HADOOP_COMMON_HOME/*,$HADOOP_COMMON_HOME/lib/*,$HADOOP_HDFS_HOME/*,$HADOOP_HDFS_HOME/lib/*,$HADOOP_YARN_HOME/*,$HADOOP_YARN_HOME/lib/*</value>
	  </property>
	  <property>
	    <name>yarn.resourcemanager.scheduler.class</name>
	    <value>org.apache.hadoop.yarn.server.resourcemanager.scheduler.fair.FairScheduler</value>
	  </property>
	  <property>
	    <name>yarn.resourcemanager.max-completed-applications</name>
	    <value>10000</value>
	  </property>
	  <property>
	    <name>yarn.nodemanager.remote-app-log-dir</name>
	    <value>/tmp/logs</value>
	  </property>
	  <property>
	    <name>yarn.nodemanager.remote-app-log-dir-suffix</name>
	    <value>logs</value>
	  </property>
	</configuration>


